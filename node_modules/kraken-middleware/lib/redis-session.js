var session = require('express-session');
var RedisStore = require('connect-redis')(session);

/**
 * 使用redis存储session值，配置在config.json中 
 * "session": {
 *     "enabled": true,
 *     "priority": 100,
 *     "module": {
 *         "name": "kraken-middleware/lib/redis-session",
 *         "arguments": [{
 *             "secret": "6de5191ab3c401bcb266dff913",
 *             "cookie": {
 *                 "path": "/",
 *                 "httpOnly": true,
 *                 "maxAge": 1800000
 *             },
 *             "resave": true,
 *             "saveUninitialized": true
 *         }, {
 *             "host": "redisDb",
 *             "port": 6379
 *         }]
 *     }
 * },
 */
module.exports = function redis(settings, redisConfig) {
	settings.store = new RedisStore(redisConfig);
	return session(settings);
};